# CiRL

This repository contains the source code of the paper: Zocco, F., Corti, A. and Malvezzi, M., 2025. CiRL: Open-source environments for reinforcement learning in circular economy and 
net zero. arXiv preprint arXiv:2505.21536. 

The repository is divided into folders; each folder refers to a thermodynamic compartment and contains the Python notebooks with the training results reported in the above-mentioned paper. The environments are summarized in the table below taken from the paper.

![EnvSummary](https://github.com/user-attachments/assets/8004f60b-2f09-4aa9-92f1-5c0e02c47671)

IMPORTANT: GitHub may not be able to render the .ipynb files when you click on them. To visualize the .ipynb without issues, download and upload them to __Google Colaboratory__. To download the repository, click on "Code" (the green button on the top-right) and scroll-down to find "Download ZIP".

Note that the files named _envName_createAndTestEnvironment.ipynb_, with "envName" indicating the name of the compartment, implement the "envName" environment without any RL agent. This was needed to tune the integration step size, namely, _dt_, of the Euler's method for solving the differential equations numerically. The numerical simulation generated by these files was then compared visually with those produced by the Python solver _scipy.integrate.odeint()_ for the same initial conditions and the same control input (i.e., the action). The solutions of the differential equations via _scipy.integrate.odeint()_ are implemented in the .py files. Once the integration step size _dt_ was found such that the Euler's method yielded outputs equivalent to those of _scipy.integrate.odeint()_, the environment was ready to be combined with an RL algorithm. The combination with the RL algorithms is implemented in the .ipynb files inside the folders "Trainings".

Further details are provided in each file.

This repository builds on the following libraries: Gymnasium (https://gymnasium.farama.org/), Gymnasium-Robotics (https://robotics.farama.org/index.html), and Stable-Baselines3 (https://stable-baselines3.readthedocs.io/en/master/index.html).

